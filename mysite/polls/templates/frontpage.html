{% extends "layout.html" %}
{% load static %}
{% block content %}
<!DOCTYPE html>
<head>
<html lang="en">
<meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" type="text/css" href="{% static '/css/main.css' %}">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.16/jquery-ui.js"></script>
    <link href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.16/themes/ui-lightness/jquery-ui.css" rel="stylesheet" type="text/css" />
	  <meta id="sal" data-name="{{languages}}" data-other="{{languages}}">
</head>
<body>     
  <div class = "container-fluid pt-3 px-4" id = "first-container" style="max-width:1000px">
    <div class = "row mt-3" id = "row">
      <div class = "col" id ="columns" >
        <div class = "title d-flex justify-content-center border-bottom border-dark text-nowrap"  style ="font-size: 40px !important" id = "title">CNN Stock Predictor</div>
      </div>
    </div>   
    <form action={% url 'polls:ticker'  %} style="text-align:center" onsubmit="return validateForm()" method="GET" id ="results" > {% csrf_token %}
      <input type="text" id="tags" name = "searchbar" placeholder=" Search ticker" autocomplete="on" >
      <input type="submit">
    </form>
    <div class = "row mt-5" id = "favorite_row" >
      <div class = "col">
        <div class="accordion" id="accordionExample">
          <div class="accordion-item">
            <h2 class="accordion-header" id="headingOne">
              <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                Top 10 Stocks with Highest 'High Estimates'
              </button>
            </h2>
            <div id="collapseOne" class="accordion-collapse collapse" aria-labelledby="headingOne" >
              <div class="accordion-body">
                <table class="table table-striped table-dark" id = "first-table" style ="text-align:center">
                </table>
              </div>
            </div>
          </div>
          <!-- </div>
          </div> -->
          <!-- <div class="accordion" id="accordionExample"> -->
          <div class="accordion-item">
            <h2 class="accordion-header" id="headingTwo">
              <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="true" aria-controls="collapseOne">
                Top 10 Stocks with Highest 'Real Prices'
              </button>
            </h2>
            <div id="collapseTwo" class="accordion-collapse collapse" aria-labelledby="headingTwo" >
              <div class="accordion-body">
                <table class="table table-striped table-dark" id = "second-table" style ="text-align:center">
                </table>
              </div>
            </div>
          </div>
          <div class="accordion-item">
            <h2 class="accordion-header" id="headingfive">
              <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseFive" aria-expanded="true" aria-controls="collapseOne">
                Top 10 Stocks with Most Annalyst Ratings
              </button>
            </h2>
            <div id="collapseFive" class="accordion-collapse collapse" aria-labelledby="headingfive" >
              <div class="accordion-body">
                <table class="table table-striped table-dark" id = "fifth-table" style ="text-align:center">
                </table>
              </div>
            </div>
          </div>
          <div class="accordion-item">
            <h2 class="accordion-header" id="headingSeven">
              <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSeven" aria-expanded="true" aria-controls="collapseOne">
                Top 10 Stocks with Highest Percentage Increases from Real Price to Median Price
              </button>
            </h2>
            <div id="collapseSeven" class="accordion-collapse collapse" aria-labelledby="headingSeven" >
              <div class="accordion-body">
                <table class="table table-striped table-dark" id = "seventh-table" style ="text-align:center">
                </table>
              </div>
            </div>
          </div>
          <div class="accordion-item">
            <h2 class="accordion-header" id="headingNine">
              <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseNine" aria-expanded="true" aria-controls="collapseOne">
                Top 10 Stocks with Highest 'Low Estimates'
              </button>
            </h2>
            <div id="collapseNine" class="accordion-collapse collapse" aria-labelledby="headingNine" >
              <div class="accordion-body">
                <table class="table table-striped table-dark" id = "ninth-table" style ="text-align:center">
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class = "col">
        <div class="accordion" id="accordionExample2">
          <div class="accordion-item">
            <h2 class="accordion-header" id="headingThree">
              <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseThree" aria-expanded="true" aria-controls="collapseOne">
                Top 10 Stocks with Lowest 'High Estimates'
              </button>
            </h2>
            <div id="collapseThree" class="accordion-collapse collapse" aria-labelledby="headingThree" >
              <div class="accordion-body">
                <table class="table table-striped table-dark" id = "third-table" style ="text-align:center">
                </table>
              </div>
            </div>
          </div>
          <!-- </div>
          </div> -->
        <div class="accordion-item">
          <h2 class="accordion-header" id="headingFour">
            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseFour" aria-expanded="true" aria-controls="collapseThree">
              Top 10 Stocks with Lowest 'Real Price'
            </button>
          </h2>
           <div id="collapseFour" class="accordion-collapse collapse" aria-labelledby="headingFour">
            <div class="accordion-body">
              <table class="table table-striped table-dark" id = "fourth-table" style ="text-align:center">
              </table>
            </div>
          </div>
        </div>
        <div class="accordion-item">
          <h2 class="accordion-header" id="headingSixth">
            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSix" aria-expanded="true" aria-controls="collapseThree">
              Top 10 Stocks with Least Annalyst Ratings
            </button>
          </h2>
           <div id="collapseSix" class="accordion-collapse collapse" aria-labelledby="headingSixth">
            <div class="accordion-body">
              <table class="table table-striped table-dark" id = "sixth-table" style ="text-align:center">
              </table>
            </div>
          </div>
        </div>
        <div class="accordion-item">
          <h2 class="accordion-header" id="headingEighth">
            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseEight" aria-expanded="true" aria-controls="collapseThree">
              Top 10 Stocks with Lowest Percentage Increases from Real Price to Median Price
            </button>
          </h2>
           <div id="collapseEight" class="accordion-collapse collapse" aria-labelledby="headingEighth">
            <div class="accordion-body ">
              <table class="table table-striped table-dark" id = "eighth-table" style ="text-align:center">
              </table>
            </div>
          </div>
        </div>
      </div>
      <div class="accordion-item">
        <h2 class="accordion-header" id="headingtenth">
          <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTen" aria-expanded="true" aria-controls="collapseThree">
            Top 10 Stocks with Lowest 'Low Estimates'
          </button>
        </h2>
         <div id="collapseTen" class="accordion-collapse collapse" aria-labelledby="headingtenth">
          <div class="accordion-body">
            <table class="table table-striped table-dark" id = "tenth-table" style ="text-align:center">
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>

<script> 
  var availableTags = [
      {% for language in languages %}
          "{{language}}",
      {% endfor %}
  ];
  $( "#tags" ).autocomplete({
    
    source: availableTags,
    minLength: 2
  });
  function validateForm() {
    var y = document.getElementById("sal").getAttribute('data-name');
    var x = document.forms["results"]["searchbar"].value.toUpperCase();
    var z = y.replaceAll("'", "").replaceAll("[","").replaceAll("]","").replaceAll(" ","");
    var store = z.split(',');
    if (x == "") {
      alert("Please enter a valid ticker");
      return false;
    }
    if(!(store.includes(x))){
        alert("Please enter a valid ticker");
        return false;
    }
  }
  window.onload = init;
  function init(){
      var table = document.getElementById("first-table");
      "{% for ticker in highEstimate %}"
          var row = table.insertRow(0);
          var x = row.insertCell(0);
          var y = row.insertCell(1); 
          x.innerHTML = "<a style =\"color:white\" href='/polls/index/"+"{{ticker.0}}"+"' >"+"{{ticker.0}}"+"</a>";"{{ticker.0}}";
          y.innerHTML = "$"+"{{ticker.1}}";
      "{% endfor %}"
      var header = table.createTHead();
      var row = header.insertRow(0);
      var y = row.insertCell(0);
      var z = row.insertCell(0);
      z.innerHTML = "Ticker";
      y.innerHTML = "High Estimate";

      var table = document.getElementById("second-table");
      "{% for ticker in highRealprice %}"
          var row = table.insertRow(0);
          var x = row.insertCell(0);
          var y = row.insertCell(1); 
          x.innerHTML = "<a style =\"color:white\" href='/polls/index/"+"{{ticker.0}}"+"' >"+"{{ticker.0}}"+"</a>";"{{ticker.0}}";
          y.innerHTML = "$"+"{{ticker.1}}";
      "{% endfor %}"
      var header = table.createTHead();
      var row = header.insertRow(0);
      var y = row.insertCell(0);
      var z = row.insertCell(0);
      z.innerHTML = "Ticker";
      y.innerHTML = "Real Price";

      var table = document.getElementById("third-table");
      "{% for ticker in lowEstimate %}"
          var row = table.insertRow(0);
          var x = row.insertCell(0);
          var y = row.insertCell(1); 
          x.innerHTML = "<a style =\"color:white\" href='/polls/index/"+"{{ticker.0}}"+"' >"+"{{ticker.0}}"+"</a>";"{{ticker.0}}";
          y.innerHTML = "$"+"{{ticker.1}}";
      "{% endfor %}"
      var header = table.createTHead();
      var row = header.insertRow(0);
      var y = row.insertCell(0);
      var z = row.insertCell(0);
      z.innerHTML = "Ticker";
      y.innerHTML = "High Estimate";

      var table = document.getElementById("fourth-table");
      "{% for ticker in lowRealPrice %}"
          var row = table.insertRow(0);
          var x = row.insertCell(0);
          var y = row.insertCell(1); 
          x.innerHTML = "<a style =\"color:white\" href='/polls/index/"+"{{ticker.0}}"+"' >"+"{{ticker.0}}"+"</a>";"{{ticker.0}}";
          y.innerHTML = "$"+"{{ticker.1}}";
      "{% endfor %}"
      var header = table.createTHead();
      var row = header.insertRow(0);
      var y = row.insertCell(0);
      var z = row.insertCell(0);
      z.innerHTML = "Ticker";
      y.innerHTML = "Real Price";

      var table = document.getElementById("fifth-table");
      "{% for ticker in highAnnalyst %}"
          var row = table.insertRow(0);
          var x = row.insertCell(0);
          var y = row.insertCell(1); 
          x.innerHTML = "<a style =\"color:white\" href='/polls/index/"+"{{ticker.0}}"+"' >"+"{{ticker.0}}"+"</a>";"{{ticker.0}}";
          y.innerHTML = "{{ticker.1}}";
      "{% endfor %}"
      var header = table.createTHead();
      var row = header.insertRow(0);
      var y = row.insertCell(0);
      var z = row.insertCell(0);
      z.innerHTML = "Ticker";
      y.innerHTML = "Annalysts";

      var table = document.getElementById("sixth-table");
      "{% for ticker in lowAnnalyst %}"
          var row = table.insertRow(0);
          var x = row.insertCell(0);
          var y = row.insertCell(1); 
          x.innerHTML = "<a style =\"color:white\" href='/polls/index/"+"{{ticker.0}}"+"' >"+"{{ticker.0}}"+"</a>";"{{ticker.0}}";
          y.innerHTML = "{{ticker.1}}";
      "{% endfor %}"
      var header = table.createTHead();
      var row = header.insertRow(0);
      var y = row.insertCell(0);
      var z = row.insertCell(0);
      z.innerHTML = "Ticker";
      y.innerHTML = "Annalysts";

      var table = document.getElementById("seventh-table");
      "{% for ticker in highPercentage %}"
          var row = table.insertRow(0);
          var x = row.insertCell(0);
          var y = row.insertCell(1); 
          x.innerHTML = "<a style =\"color:white\" href='/polls/index/"+"{{ticker.0}}"+"' >"+"{{ticker.0}}"+"</a>";"{{ticker.0}}";
          y.innerHTML = "{{ticker.1}}" + "%";
      "{% endfor %}"
      var header = table.createTHead();
      var row = header.insertRow(0);
      var y = row.insertCell(0);
      var z = row.insertCell(0);
      z.innerHTML = "Ticker";
      y.innerHTML = "Percentage Increase";

      var table = document.getElementById("eighth-table");
      "{% for ticker in lowPercentage %}"
          var row = table.insertRow(0);
          var x = row.insertCell(0);
          var y = row.insertCell(1); 
          x.innerHTML = "<a style =\"color:white\" href='/polls/index/"+"{{ticker.0}}"+"' >"+"{{ticker.0}}"+"</a>";"{{ticker.0}}";
          y.innerHTML = "{{ticker.1}}" + "%";
      "{% endfor %}"
      var header = table.createTHead();
      var row = header.insertRow(0);
      var y = row.insertCell(0);
      var z = row.insertCell(0);
      z.innerHTML = "Ticker";
      y.innerHTML = "Percentage Increase";

      var table = document.getElementById("ninth-table");
      "{% for ticker in highLow %}"
          var row = table.insertRow(0);
          var x = row.insertCell(0);
          var y = row.insertCell(1); 
          x.innerHTML = "<a style =\"color:white\" href='/polls/index/"+"{{ticker.0}}"+"' >"+"{{ticker.0}}"+"</a>";"{{ticker.0}}";
          y.innerHTML = "$"+"{{ticker.1}}";
      "{% endfor %}"
      var header = table.createTHead();
      var row = header.insertRow(0);
      var y = row.insertCell(0);
      var z = row.insertCell(0);
      z.innerHTML = "Ticker";
      y.innerHTML = "Low Estimate";

      var table = document.getElementById("tenth-table");
      "{% for ticker in lowLow %}"
          var row = table.insertRow(0);
          var x = row.insertCell(0);
          var y = row.insertCell(1); 
          x.innerHTML = "<a style =\"color:white\" href='/polls/index/"+"{{ticker.0}}"+"' >"+"{{ticker.0}}"+"</a>";"{{ticker.0}}";
          y.innerHTML = "$"+"{{ticker.1}}";
      "{% endfor %}"
      var header = table.createTHead();
      var row = header.insertRow(0);
      var y = row.insertCell(0);
      var z = row.insertCell(0);
      z.innerHTML = "Ticker";
      y.innerHTML = "Low Estimate";
  }
</script>
</body>
</html>
{% endblock %}